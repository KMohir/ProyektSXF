# üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
telegram-task-bot/
‚îÇ
‚îú‚îÄ‚îÄ üìÑ –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ bot.py                      # –ì–ª–∞–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –±–æ—Ç–∞ (–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏, FSM)
‚îÇ   ‚îú‚îÄ‚îÄ run.py                      # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ config.py                   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ db.py                       # –†–∞–±–æ—Ç–∞ —Å PostgreSQL
‚îÇ   ‚îú‚îÄ‚îÄ sheets.py                   # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Sheets
‚îÇ   ‚îî‚îÄ‚îÄ keyboards.py                # –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã –¥–ª—è –±–æ—Ç–∞
‚îÇ
‚îú‚îÄ‚îÄ üìÅ utils/                       # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ logger.py                   # –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Å —Ä–æ—Ç–∞—Ü–∏–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ cache.py                    # –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ decorators.py               # –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã (retry, logging)
‚îÇ   ‚îú‚îÄ‚îÄ health_check.py             # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îî‚îÄ‚îÄ backup.py                   # –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ë–î
‚îÇ
‚îú‚îÄ‚îÄ üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ .env                        # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–Ω–µ –≤ git)
‚îÇ   ‚îú‚îÄ‚îÄ .env.example                # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ credentials.json            # Google Sheets API –∫–ª—é—á–∏ (–Ω–µ –≤ git)
‚îÇ   ‚îî‚îÄ‚îÄ .gitignore                  # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ —Ñ–∞–π–ª—ã
‚îÇ
‚îú‚îÄ‚îÄ üöÄ –°–∫—Ä–∏–ø—Ç—ã –∑–∞–ø—É—Å–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ install.sh / install.bat    # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ run.sh / run.bat            # –ó–∞–ø—É—Å–∫ —Å –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–º
‚îÇ   ‚îú‚îÄ‚îÄ check_health.sh / .bat      # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt            # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îÇ
‚îú‚îÄ‚îÄ üê≥ Docker
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile                  # Docker –æ–±—Ä–∞–∑
‚îÇ   ‚îî‚îÄ‚îÄ docker-compose.yml          # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ
‚îú‚îÄ‚îÄ üîÑ Systemd (Linux)
‚îÇ   ‚îú‚îÄ‚îÄ telegram-bot.service        # Systemd unit —Ñ–∞–π–ª
‚îÇ   ‚îî‚îÄ‚îÄ setup_systemd.sh            # –°–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–µ—Ä–≤–∏—Å–∞
‚îÇ
‚îú‚îÄ‚îÄ üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
‚îÇ   ‚îú‚îÄ‚îÄ monitor.py                  # –°–∫—Ä–∏–ø—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
‚îÇ   ‚îî‚îÄ‚îÄ crontab.example             # –ü—Ä–∏–º–µ—Ä—ã cron –∑–∞–¥–∞—á
‚îÇ
‚îî‚îÄ‚îÄ üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
    ‚îú‚îÄ‚îÄ README.md                   # –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
    ‚îú‚îÄ‚îÄ QUICKSTART.md               # –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
    ‚îú‚îÄ‚îÄ DEPLOYMENT.md               # –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é
    ‚îî‚îÄ‚îÄ PROJECT_STRUCTURE.md        # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üîë –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### bot.py (1000+ —Å—Ç—Ä–æ–∫)
- **–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥**: /start, /help, /cancel
- **FSM —Å–æ—Å—Ç–æ—è–Ω–∏—è**: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –≤—ã–±–æ—Ä –ø—Ä–æ–µ–∫—Ç–æ–≤/–∑–∞–¥–∞—á
- **Middleware**: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –ì–ª–æ–±–∞–ª—å–Ω—ã–π error handler
- **–ê–¥–º–∏–Ω-—Ñ—É–Ω–∫—Ü–∏–∏**: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –ø—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∑–∞–¥–∞—á
- **Callback handlers**: –û–¥–æ–±—Ä–µ–Ω–∏–µ/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á

### db.py (400+ —Å—Ç—Ä–æ–∫)
- **Connection pooling**: 5-20 —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- **–¢–∞–±–ª–∏—Ü—ã**: users, tasks, action_logs
- **–ò–Ω–¥–µ–∫—Å—ã**: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- **Retry –º–µ—Ö–∞–Ω–∏–∑–º**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä—ã
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**: –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏ –∑–∞–¥–∞—á–∞–º
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### sheets.py (300+ —Å—Ç—Ä–æ–∫)
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞**: gspread-asyncio
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –°–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ API
- **Batch –æ–ø–µ—Ä–∞—Ü–∏–∏**: –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –∑–∞–ø–∏—Å—å
- **Retry –º–µ—Ö–∞–Ω–∏–∑–º**: –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —Å–±–æ—è–º
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏**: –ü–æ–ª—É—á–µ–Ω–∏–µ –ª–∏—Å—Ç–æ–≤ –∏ –∑–∞–¥–∞—á

### config.py (100+ —Å—Ç—Ä–æ–∫)
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- **–¢–∏–ø–∏–∑–∞—Ü–∏—è**: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö
- **–°–æ–æ–±—â–µ–Ω–∏—è**: –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∏**: –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ

### utils/ (500+ —Å—Ç—Ä–æ–∫)
- **logger.py**: –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **cache.py**: In-memory –∫—ç—à —Å TTL
- **decorators.py**: Retry, logging –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã
- **health_check.py**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ë–î –∏ Google Sheets
- **backup.py**: –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–¥–∞

- **–í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤**: 30+
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞**: ~3000+
- **Python –º–æ–¥—É–ª–µ–π**: 10
- **–£—Ç–∏–ª–∏—Ç**: 6
- **–°–∫—Ä–∏–ø—Ç–æ–≤**: 8
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏**: 5 —Ñ–∞–π–ª–æ–≤

## üîÑ –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    ‚Üì
Telegram Bot (bot.py)
    ‚Üì
FSM States (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è/–≤—ã–±–æ—Ä)
    ‚Üì
Database (db.py) ‚Üê‚Üí Google Sheets (sheets.py)
    ‚Üì
–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã (—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)
    ‚Üì
–û–¥–æ–±—Ä–µ–Ω–∏–µ/–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ
    ‚Üì
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î –∏ Sheets
    ‚Üì
–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

## üõ°Ô∏è –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å

### –£—Ä–æ–≤–Ω–∏ –∑–∞—â–∏—Ç—ã:
1. **Retry –º–µ—Ö–∞–Ω–∏–∑–º** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä—ã
2. **Connection pooling** - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
3. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Å–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏
4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø–æ–ª–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞
5. **Health checks** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è
6. **–ê–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫** - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å–±–æ–µ–≤
7. **Backup** - —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

## üìà –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (asyncio)
- –ü—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –ë–î (5-20)
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å TTL (300 —Å–µ–∫)
- –ò–Ω–¥–µ–∫—Å—ã –≤ –ë–î
- Batch –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å Sheets
- Middleware –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ú–µ—Ä—ã –∑–∞—â–∏—Ç—ã:
- .env –¥–ª—è —Å–µ–∫—Ä–µ—Ç–æ–≤
- .gitignore –¥–ª—è credentials
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø—Ä–∞–≤ systemd —Å–µ—Ä–≤–∏—Å–∞

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç—ã:
1. **–õ–æ–∫–∞–ª—å–Ω–æ** - –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
2. **VPS + systemd** - –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
3. **Docker** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
4. **Docker Compose** - —Å PostgreSQL

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –£—Ä–æ–≤–Ω–∏:
- **DEBUG** - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- **INFO** - –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
- **WARNING** - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- **ERROR** - –æ—à–∏–±–∫–∏

### –ú–µ—Å—Ç–∞:
- –ö–æ–Ω—Å–æ–ª—å (stdout)
- –§–∞–π–ª bot.log (—Ä–æ—Ç–∞—Ü–∏—è 10MB √ó 5)
- Systemd journal (journalctl)

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ú–µ—Ç—Ä–∏–∫–∏:
- CPU, RAM, Disk
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–¥–∞—á
- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –¢–æ–ø –ø—Ä–æ–µ–∫—Ç–æ–≤

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:
- –û—Ç—á–µ—Ç—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö
- –°—Ç–∞—Ç—É—Å –∑–∞–ø—É—Å–∫–∞/–æ—Å—Ç–∞–Ω–æ–≤–∫–∏